#!/usr/bin/env bash

clear

set -euo pipefail

[[ -f /etc/os-release ]] && . /etc/os-release

if [[ $ID != "arch" ]]; then
    echo "OS not detected as archlinux"
    exit 1
fi

sudo -v
timestamp_sudo() {
    while :; do
        sudo -v
        sleep 45
    done
}
timestamp_sudo &
timestamp_sudo_pid=$!
trap "sudo -k; kill -9 $timestamp_sudo_pid 2>/dev/null;" EXIT SIGINT SIGTERM

source ./hardware/network
source ./hardware/bluetooth
source ./hardware/pipewire
source ./hardware/battery
source ./hardware/graphic

source ./desktop/dotfiles
source ./desktop/swaywm
source ./desktop/rofi
source ./desktop/waybar
source ./desktop/swaync
source ./desktop/core
source ./desktop/browsers
source ./desktop/flameshot
source ./desktop/ime
source ./desktop/udiskie
source ./desktop/nerdfonts
source ./desktop/theme

source ./devtools/nodejs
source ./devtools/golang
source ./devtools/php
source ./devtools/rust
source ./devtools/neovim
source ./devtools/vscode
source ./devtools/git
source ./devtools/docker

if ! [[ -d $HOME/.extras ]]; then
    git clone https://github.com/akbarsanihasan/setup-extras "$HOME"/.extras
fi

clear
echo "Success, need reboot"
